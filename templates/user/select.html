<!DOCTYPE html>
{% load static %}
{% load socialaccount %}
<html lang="en" class="demo-2">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Mentor Buddy</title>
	<link rel="stylesheet" type="text/css" href="{% static 'css/user/select/normalize.css' %}" />
	<link rel="stylesheet" type="text/css" href="{% static 'css/user/select/component.css' %}" />
	<link rel="stylesheet" type="text/css" href="{% static 'css/user/select/select.css' %}" />

	<script src="{% static 'js/user/select/snap.svg-min.js' %}"></script>
</head>
<body>
	<h1 style="text-align: center;">So, what would you like to be?</h1>

	<div id="selectError">
	</div>

	<!-- Selection FOrm -->
	<form action="/user/select/" method="POST" id="selectionForm" autocomplete="off">
		{% csrf_token %}
	    Please select your options:<br>
	    <input type="radio" id="menteeChoice" name="choice" value="mentee">Mentor<br>
	    <input type="radio" id="mentorChoice" name="choice" value="mentor">Mentee<br>
	    <input type='submit' name="formSubmit" value="SUBMIT">
	</form>

	<!-- Password form -->
	<form class="passwordForm" method="POST" action="/user/select/password/" autocomplete="off">
	  {% csrf_token %}
  	  <div id="signUpError">
	  </div>
  	  <div class="group">
        <input type="password" name="password" id="p1"><span class="highlight"></span><span class="bar"></span>
        <label>Password</label>
      </div>
      <div class="group">
        <input type="password" name="confirmPassword" id="p2"><span class="highlight"></span><span class="bar"></span>
        <label>Confirm Password</label>
      </div>
      
      <button type="submit" class="button buttonBlue">Submit
        <div class="ripples buttonRipples"><span class="ripplesCircle"></span></div>
      </button>
      
    </form>

	<section id="grid" class="grid clearfix">
		<div class="wrapper">
		<a href="#" id="menteeBlock" data-path-hover="m 0,0 0,47.7775 c 24.580441,3.12569 55.897012,-8.199417 90,-8.199417 34.10299,0 65.41956,11.325107 90,8.199417 L 180,0 z">
			<figure>
				<img src="{% static 'img/mentee.png' %}" />
				<svg viewBox="0 0 180 320" preserveAspectRatio="none"><path d="m 0,0 0,171.14385 c 24.580441,15.47138 55.897012,24.75772 90,24.75772 34.10299,0 65.41956,-9.28634 90,-24.75772 L 180,0 0,0 z"/></svg>
				<figcaption>
					<h2>Mentee</h2>
					<p>I'm here for some help!</p>
					<button>Select</button>
				</figcaption>
			</figure>
		</a>
		<a href="#" id="mentorBlock" data-path-hover="m 0,0 0,47.7775 c 24.580441,3.12569 55.897012,-8.199417 90,-8.199417 34.10299,0 65.41956,11.325107 90,8.199417 L 180,0 z">
			<figure>
				<img src="{% static 'img/mentor.png' %}" />
				<svg viewBox="0 0 180 320" preserveAspectRatio="none"><path d="m 0,0 0,171.14385 c 24.580441,15.47138 55.897012,24.75772 90,24.75772 34.10299,0 65.41956,-9.28634 90,-24.75772 L 180,0 0,0 z"/></svg>
				<figcaption>
					<h2>Mentor</h2>
					<p>I'm here to help people!</p>
					<button>Select</button>
				</figcaption>
			</figure>
		</a>
	</div>
	</section>
	<!-- Jquery -->
    <script type="text/javascript" src="{% static 'jquery/jquery-2.1.3.min.js' %}"></script>   

	<script>
		$(document).ready(function() {
			$(".passwordForm").hide();
		});
		(function() {

			function init() {
				var speed = 330,
					easing = mina.backout;

				[].slice.call ( document.querySelectorAll( '.wrapper > a' ) ).forEach( function( el ) {
					var s = Snap( el.querySelector( 'svg' ) ), path = s.select( 'path' ),
						pathConfig = {
							from : path.attr( 'd' ),
							to : el.getAttribute( 'data-path-hover' )
						};

					el.addEventListener( 'mouseenter', function() {
						path.animate( { 'path' : pathConfig.to }, speed, easing );
					} );

					el.addEventListener( 'mouseleave', function() {
						path.animate( { 'path' : pathConfig.from }, speed, easing );
					} );
				} );
			}

			init();

		})();
		(function() {
			var mentee = document.getElementById('menteeBlock');
			mentee.addEventListener( 'click', function() {
				document.getElementById('menteeChoice').checked = true;
				//document.getElementById("selectionForm").submit();
				submitSelectionForm();

			});
		})();

		(function() {
			var mentor = document.getElementById('mentorBlock');
			mentor.addEventListener( 'click', function() {
				document.getElementById('mentorChoice').checked = true;
				//document.getElementById("selectionForm").submit();
				submitSelectionForm();
			});
		})();
	</script>

	<!-- Ajax Submission for selection form -->
	<script type="text/javascript">
		function submitSelectionForm() {
			var postData = $('#selectionForm').serializeArray();
            var msg='';
            $.ajax({
                url: '/user/select/',
                type: 'POST',
                data: postData,
                dataType: 'json',
                success: function(data) {
                    if(data["error"] == true) {
                        $("#selectError").html(data['message']);
                    }
                    else { 
                        msg = "You're just one step away!<br>We have sent you a verification email. Check for the same! ";
                        $('.grid').fadeOut();
                        setTimeout(function() {
                        	$(".passwordForm").fadeIn();
                        },1000); 
                    }
                },
                error: function(data) {
                    alert("Oops! ajax error");
                }
            });
		
		}
	</script>

	<!-- Password Form JS -->
    <script type="text/javascript">
        $(window, document, undefined).ready(function() {
          $('input').blur(function() {
            var $this = $(this);
            if ($this.val())
              $this.addClass('used');
            else
              $this.removeClass('used');
          });

          var $ripples = $('.ripples');

          $ripples.on('click.Ripples', function(e) {

            var $this = $(this);
            var $offset = $this.parent().offset();
            var $circle = $this.find('.ripplesCircle');

            var x = e.pageX - $offset.left;
            var y = e.pageY - $offset.top;

            $circle.css({
              top: y + 'px',
              left: x + 'px'
            });

            $this.addClass('is-active');

          });

          $ripples.on('animationend webkitAnimationEnd mozAnimationEnd oanimationend MSAnimationEnd', function(e) {
            $(this).removeClass('is-active');
          });
        });
	</script>

    <!-- Ajax Submission for selection form -->
	<script type="text/javascript">
		$(document).ready(function() {
			$(".passwordForm").submit(function(e) {
				e.preventDefault();
				var postData = $(this).serializeArray();
	            var msg='';
	            $.ajax({
	                url: '/user/select/password/',
	                type: 'POST',
	                data: postData,
	                dataType: 'json',
	                success: function(data) {
	                    if(data["error"] == true) {
	                        $("#selectError").html(data['message']);
	                    }
	                    else {
	                     	$("#selectError").html("");
	                     	location.reload();    
	                    }
	                },
	                error: function(data) {
	                    alert("Oops! ajax error");
	                }
	            });
			});
		});
	</script>
</body>
</html>
